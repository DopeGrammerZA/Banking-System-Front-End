<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Register | Secure Bank</title>

  <!-- üîµ EMBEDDED BLUE THEME CSS -->
  <style>
    :root{
      --bg-1: #eef6ff;
      --card: #ffffff;
      --primary: #2563eb;
      --primary-dark: #1e56c9;
      --muted: #6b7280;
      --accent: #10b981;
      --card-radius: 14px;
      --shadow: 0 10px 30px rgba(37,99,235,0.08);
      --max-width: 460px;
      font-family: "Inter", "Segoe UI", system-ui, -apple-system, Arial;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100vh;
      background: linear-gradient(180deg, #f5fbff, var(--bg-1));
      display:flex;
      justify-content:center;
      align-items:center;
      padding:24px;
      color:#0f172a;
    }

    .card{
      width:100%;
      max-width:var(--max-width);
      background:var(--card);
      border-radius:var(--card-radius);
      box-shadow:var(--shadow);
      padding:26px;
      border:1px solid rgba(15,23,42,0.05);
    }

    .app-logo {
        font-size: 60px;        /* Bigger icon */
        background: #1e40af;    /* Same blue branding as dashboard */
        color: white;
        width: 80px;
        height: 80px;
        border-radius: 20px;    /* Rounded square */
        display: flex;
        justify-content: center;
        align-items: center;
        box-shadow: 0 6px 15px rgba(37,99,235,0.25);
    }

    .h1{
      font-size:22px;
      font-weight:700;
      margin:0;
    }
    .h-sub{
      font-size:14px;
      color:var(--muted);
      margin-top:4px;
    }

    .badge-secure{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:6px 10px;
      background:#ecfdf5;
      color:#065f46;
      border-radius:20px;
      font-size:13px;
      border:1px solid rgba(6,95,70,0.1);
    }

    .form{
      display:grid;
      gap:16px;
    }

    .field{display:flex;flex-direction:column;gap:6px}
    .label{
      font-size:14px;
      font-weight:600;
      color:#0f172a;
    }

    /* INPUT + ICON */
    .input-with-icon{
      position:relative;
      display:flex;
      align-items:center;
    }
    .icon-left{
      position:absolute;
      left:12px;
      font-size:18px;
      color:#94a3b8;
    }
    .icon-right{
      position:absolute;
      right:10px;
      background:none;
      border:0;
      font-size:18px;
      cursor:pointer;
      color:#64748b;
    }

    input{
      width:100%;
      padding:12px 44px;
      border-radius:10px;
      border:1px solid #e6eefc;
      background:#f7f9ff;
      font-size:15px;
      color:#0f172a;
    }
    input:focus{
      outline:none;
      border-color:var(--primary);
      box-shadow:0 4px 14px rgba(37,99,235,0.18);
    }

    .btn{
      width:100%;
      padding:12px;
      font-size:16px;
      font-weight:700;
      border-radius:10px;
      cursor:pointer;
      border:0;
    }
    .btn-primary{
      background:var(--primary);
      color:white;
      box-shadow:0 8px 20px rgba(37,99,235,0.2);
    }
    .btn-primary:hover{
      background:var(--primary-dark);
    }

    .btn-ghost{
      background:transparent;
      color:var(--primary);
      border:2px solid rgba(37,99,235,0.15);
    }

    .helper{
      text-align:center;
      font-size:13px;
      color:var(--muted);
    }

    .footer-note{
      margin-top:14px;
      text-align:center;
      font-size:13px;
      color:var(--muted);
    }
  </style>
</head>

<body>

  <main class="card" role="main" aria-labelledby="registerTitle">

    <div style="display:flex;flex-direction:column;align-items:center;margin-bottom:10px">
      <!-- REGISTER LOGO IMAGE -->
    <div style="display:flex;flex-direction:column;align-items:center;margin-bottom:10px">
    <div class="app-logo">
        üè¶
    </div>
      <div style="font-weight:700;font-size:18px;margin-top:6px">SecureBank</div>
      <div style="color:#64748b;font-size:14px">Join SecureBank today</div>
    </div>

    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:14px">
      <div>
        <h2 id="registerTitle" class="h1">Create Account</h2>
        <div class="h-sub">Join SecureBank today</div>
      </div>
      <div class="badge-secure">üîí Secure</div>
    </div>

    <form id="regForm" class="form">

      <div class="field">
        <label class="label" for="uname">Username</label>
        <div class="input-with-icon">
          <span class="icon-left">üë§</span>
          <input id="uname" name="username" type="text" placeholder="Choose a username" required>
        </div>
      </div>

      <div class="field">
        <label class="label" for="email">Email Address</label>
        <div class="input-with-icon">
          <span class="icon-left">‚úâÔ∏è</span>
          <input id="email" name="email" type="email" placeholder="your@email.com" required>
        </div>
      </div>

      <div class="field">
        <label class="label" for="pwd1">Password</label>
        <div class="input-with-icon">
          <span class="icon-left">üîí</span>
          <input id="pwd1" name="password" type="password" placeholder="Create a strong password" required minlength="6">
          <button type="button" class="icon-right" id="toggleRegPw1">üëÅÔ∏è</button>
        </div>
      </div>

      <div class="field">
        <label class="label" for="pwd2">Confirm Password</label>
        <div class="input-with-icon">
          <span class="icon-left">üîí</span>
          <input id="pwd2" name="confirm" type="password" placeholder="Confirm your password" required minlength="6">
          <button type="button" class="icon-right" id="toggleRegPw2">üëÅÔ∏è</button>
        </div>
      </div>

      <button type="submit" class="btn btn-primary" id="createBtn">Create Account</button>
      <button type="button" class="btn btn-ghost" onclick="location.href='login.html'">Already have an account? Sign in</button>

      <div class="helper">
        By creating an account, you agree to SecureBank‚Äôs  
        <a href="#" style="color:var(--primary)">Terms</a> &  
        <a href="#" style="color:var(--primary)">Privacy Policy</a>.
      </div>

    </form>

    <div class="footer-note">¬© 2025 SecureBank ‚Ä¢ Your money, secured your way.</div>

  </main>

  <script>
    // REGISTER PAGE JS
    (function(){
      const form = document.getElementById('regForm');
      const pwd1 = document.getElementById('pwd1');
      const pwd2 = document.getElementById('pwd2');

      document.getElementById('toggleRegPw1').onclick = () => {
        const hidden = pwd1.type === 'password';
        pwd1.type = hidden ? 'text' : 'password';
        toggleRegPw1.textContent = hidden ? 'üôà' : 'üëÅÔ∏è';
      };

      document.getElementById('toggleRegPw2').onclick = () => {
        const hidden = pwd2.type === 'password';
        pwd2.type = hidden ? 'text' : 'password';
        toggleRegPw2.textContent = hidden ? 'üôà' : 'üëÅÔ∏è';
      };

        form.onsubmit = async (e) => {
        e.preventDefault(); // stop normal submission

        // basic validation
        if (!form.username.value.trim()){
            alert("Please choose a username");
            return;
        }
        // Email validation ‚Äî must contain @ AND end with .com or .co.za
        const email = form.email.value;

        if (
            !email.includes("@") || 
            !(email.endsWith(".com") || email.endsWith(".co.za"))
        ) {
            alert("Please enter a valid email ending with .com or .co.za");
            return;
        }
        if (pwd1.value.length < 6){
            alert("Password must be at least 6 characters");
            return;
        }
        if (pwd1.value !== pwd2.value){
            alert("Passwords do not match");
            return;
        }

        const btn = document.getElementById('createBtn');
        btn.disabled = true;
        btn.textContent = "Creating...";

        const payload = {
            username: form.username.value,
            email: form.email.value,
            password: pwd1.value
        };

        try {
            const res = await fetch("http://127.0.0.1:8000/register", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(payload)
            });

            const data = await res.json();

            if (res.ok) {
                alert("Account created successfully!");

                // Save user info so the dashboard can read it
                localStorage.setItem("username", form.username.value);
                localStorage.setItem("email", form.email.value);

                window.location.href = "login.html";
            } else {
                alert(data.detail || "Registration failed");
                btn.disabled = false;
                btn.textContent = "Create Account";
            }

        } catch (err) {
            alert("Error connecting to server");
            btn.disabled = false;
            btn.textContent = "Create Account";
        }
        };

    })();
  </script>

</body>
</html>
